# Информационная безопасность - задания

- Задания индивидуальные, выполнять их нужно самостоятельно. 
- Результат выполнения выложите в свой приватный репозиторий
- Дайте доступ к репозиторию пользователю gltronred
- В README укажите, как вас зовут, где находится решение задания, как оно работает, 
  как его запускать и т.п.

# 1

Режимы шифрования нужны, чтобы одинаковые блоки не переходили в одинаковые (как
в режиме ECB). Поскольку блоки короткие, в результате всё ещё видно внутреннюю
структуру файла, особенно если это большой медиафайл.

Кроме того, зашифрованное в режиме ECB можно расшифровать побайтово.

Напишите код, который при запуске генерирует случайный ключ K и секретную строку
S. Можно представить, например, что S - некая соль. Далее код предоставляет доступ к функции

f(x) = AES-128-ECB(x || S, K),

т.е. даёт возможность шифровать результат конкатенации x и S ключом K. Доступ
может быть, например, через ввод-вывод, http-запрос и т.п.

Ваша задача - написать код, который, имея доступ к f, получит строку S.

Для этого вы можете составить словарь блоков вида A...AA, A...AB, ..., A...AZ
(длина - один блок, последний символ пробегает все возможные символы) и сравнить
его с первым блоком результата шифрования A...A (длина на один меньше, чем длина
блока). Далее аналогичным образом вычисляется второй и последующие символы
строки S.

# 2

MAC - message authentication code - применяется для аутентификации сообщений
(проверки их подлинности). У обоих участников есть общий секретный ключ K, Алиса
генерирует (sign) метку t = S(K,m) для сообщения m, Боб проверяет (verify) метку
при помощи какого-то метода V(K,m,t).

Два свойства безопасности MAC: 

- корректная метка сообщения всегда принимается;
- злоумышленник, имея доступ к генерации и проверке меток, но не имея доступа к
  секретному ключу, не может (точнее, вероятность такого мала) сгенерировать для
  какого-либо сообщения метку, которая пройдёт проверку
  
Как видно, свойства безопасности MAC отличаются от свойств безопасности
хэш-функций. Их не надо путать

Ваша задача состоит во "взломе" CBC-MAC, который некорректно используется вместо
хэша.

CBC-MAC - способ получения MAC из блочного шифра. Строка шифруется в режиме CBC,
последний шифр-блок используется как метка.

В странном сайте вместо проверки хэша загружаемого javascript используется
AES-128-CBC-MAC, с ключом "YELLOW SUBMARINE" и IV полностью из нулевых символов.

На странице загружается код

``` javascript
alert("Hello world!");
```

Найдите такой корректный javascript-код, который запустит `alert("You are
pwned!");`, с совпадающей с CBC-MAC-меткой предыдущего кода.

# 3

Протокол обмена ключами Диффи-Хеллмана применяется для генерации общего
секретного ключа.

- В протоколе фиксируются параметры `p` - простое число и `g` - генератор группы `Z_p` (группы вычетов по модулю p)
- Алиса случайным образом выбирает секретный ключ `a` из `Z_p` и вычисляет открытый ключ `A = g^a mod p`
- Боб случайным образом выбирает секретный ключ `b` из `Z_p` и вычисляет открытый ключ `B = g^b mod p`
- Алиса передаёт свой открытый ключ `A` Бобу
- Боб передаёт свой открытый ключ `B` Алисе
- обе стороны вычисляют общий секретный ключ `S = A^b mod p = B^a mod p = g^{ab} mod p**

Подслушивающая злоумышленница Ева не может узнать секретный ключ, т.к. ей для
этого нужно решить задачу вычисления дискретного логарифма, которая считается
сложной.

**Задача.** Описать способ взлома некорректного протокола Диффи-Хеллмана, в котором:
- параметр `g` не зафиксирован в протоколе, а выбирается каждый раз заново
- Ева может повлиять на его выбор, установив `g = p-1`
- Ева **не** может менять никакие другие сообщения, но она может подслушивать
  сообщения, передаваемые сторонами; после выполнения всех шагов Ева должна
  вычислить секретный ключ `S`, который должен совпасть с ключом Алисы и Боба
- Алиса и Боб выполняют операции так же, как и в обычном протоколе 
